(()=>{var t={776:(t,e,i)=>{"use strict";const n=i(279),s=i(171),o=i(69),r=i(712),a=i(389);class d{static reset(){points=[],population=[]}static addPoint(t,e){d.points.push(new a(t,e))}static initAlgorithm(){d.population=[],r.init();for(let t of d.points)r.addCity(new s(t.x,t.y));d.population=new o(2*points.length,!0)}static iterateAlgorithm(){d.population=n.evolvePopulation(population);const t=population.getFittest();return{route:t,distance:t.getDistance(),numberOfCities:r.numberOfCities()}}}d.points=[],d.population=[],t.exports=d},389:t=>{"use strict";t.exports=class{constructor(t,e){this.x=t,this.y=e}}},171:t=>{"use strict";t.exports=class{constructor(t,e){this.x=t||Math.floor(200*Math.random()),this.y=e||Math.floor(200*Math.random())}distanceTo(t){let e=Math.abs(this.x-t.x),i=Math.abs(this.y-t.y);return Math.sqrt(e*e+i*i)}toString(){return`${this.x}, ${this.y}`}}},38:t=>{"use strict";t.exports=class{static shuffleArray(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t}}},279:(t,e,i)=>{"use strict";const n=i(69),s=i(462);class o{static get mutationRate(){return.05}static get tournamentSize(){return 5}static get elitism(){return!0}static evolvePopulation(t){let e=new n(t.populationSize(),!1),i=0;o.elitism&&(e.saveRoute(0,t.getFittest()),i=1);for(let n=i;n<e.populationSize();n++){let i=o.rouletteSelection(t),s=o.rouletteSelection(t),r=o.crossover(i,s);e.saveRoute(n,r)}for(let t=i;t<e.populationSize();t++)o.mutate(e.getRoute(t));return e}static crossover(t,e){let i=new s,n=Math.floor(Math.random()*t.routeSize()),o=Math.floor(Math.random()*t.routeSize());for(let e=0;e<i.routeSize();e++)n<o&&e>n&&e<o?i.setCity(e,t.getCity(e)):n>o&&(e<n&&e>o||i.setCity(e,t.getCity(e)));for(let t=0;t<e.routeSize();t++)if(!i.containsCity(e.getCity(t)))for(let n=0;n<i.routeSize();n++)if(null==i.getCity(n)){i.setCity(n,e.getCity(t));break}return i}static mutate(t){for(let e=0;e<t.routeSize();e++)if(Math.random()<o.mutationRate){let i=Math.floor(t.routeSize()*Math.random()),n=t.getCity(e),s=t.getCity(i);t.setCity(i,n),t.setCity(e,s)}}static tournamentSelection(t){let e=new n(o.tournamentSize,!1);for(let i=0;i<o.tournamentSize;i++){let n=Math.floor(Math.random()*t.populationSize());e.saveRoute(i,t.getRoute(n))}return e.getFittest()}static rouletteSelection(t){let e=0;for(let i=0;i<t.populationSize();i++)e+=t.getRoute(i).getFitness();let i=Math.random()*e,n=0;for(let e=0;e<t.populationSize();e++)if(n+=t.getRoute(e).getFitness(),n>i)return t.getRoute(e);throw`Can't find candidate in the roullete: winnerSum: ${n}, sumOfFitness: ${e}, rouletteNumber: ${i}`}}t.exports=o},69:(t,e,i)=>{"use strict";const n=i(462);t.exports=class{constructor(t,e){if(this.routes=new Array(t),e)for(let t=0;t<this.populationSize();t++){let e=new n;e.generateRandomIndividual(),this.saveRoute(t,e)}}saveRoute(t,e){this.routes[t]=e}getRoute(t){return this.routes[t]}getFittest(){let t=this.routes[0];for(let e=1;e<this.populationSize();e++)t.getFitness()<=this.getRoute(e).getFitness()&&(t=this.getRoute(e));return t}populationSize(){return this.routes.length}}},462:(t,e,i)=>{"use strict";const n=i(712),s=i(38);t.exports=class{constructor(t){if(this.fitness=0,this.distance=0,t)this.route=t;else{this.route=[];for(let t=0;t<n.numberOfCities();t++)this.route.push(void 0)}}generateRandomIndividual(){for(let t=0;t<n.numberOfCities();t++)this.setCity(t,n.getCity(t));this.route=s.shuffleArray(this.route)}getCity(t){return this.route[t]}setCity(t,e){this.route[t]=e,this.fitness=0,this.distance=0}getFitness(){return 0==this.fitness&&(this.fitness=1/this.getDistance()),this.fitness}getDistance(){if(0==this.distance){let t=0;for(let e=0;e<this.routeSize();e++){let i,n=this.getCity(e);i=e+1<this.routeSize()?this.getCity(e+1):this.getCity(0),t+=n.distanceTo(i)}this.distance=t}return this.distance}routeSize(){return this.route.length}containsCity(t){return-1!=this.route.indexOf(t)}toString(){let t="|";for(let e=0;e<this.routeSize();e++)t+=this.getCity(e)+"|";return t}}},712:t=>{"use strict";let e=[];t.exports=class{static init(){e=[]}static get destinationCities(){return e}static addCity(t){e.push(t)}static getCity(t){return e[t]}static numberOfCities(){return e.length}}}},e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={exports:{}};return t[n](s,s.exports,i),s.exports}(()=>{const t=i(776);let e,n,s,o,r,a=0,d=0;class l{static init(){o=document.getElementsByTagName("canvas")[0],e=o.width,n=o.height,document.getElementById("reset").onclick=this.resetUI,document.getElementById("add-5-point").onclick=this.add5Point,document.getElementById("add-point").onclick=this.addPoint,document.getElementById("start").onclick=this.start,document.getElementById("start-limited").onclick=this.startLimited,document.getElementById("stop").onclick=this.stop}static stop(){document.getElementById("start").disabled=!1,s&&clearInterval(s)}static start(){document.getElementById("add-5-point").disabled=!0,document.getElementById("add-point").disabled=!0,document.getElementById("start").disabled=!0,document.getElementById("start-limited").disabled=!0,document.getElementById("stop").disabled=!1,0==a&&(t.initAlgorithm(),s=setInterval((function(){a++,l.draw(t.iterateAlgorithm(),a)}),30))}static startLimited(){document.getElementById("add-5-point").disabled=!0,document.getElementById("add-point").disabled=!0,document.getElementById("start").disabled=!0,document.getElementById("start-limited").disabled=!0,document.getElementById("stop").disabled=!1,0==a&&(t.initAlgorithm(),s=setInterval((function(){a++;let e=t.iterateAlgorithm();Number(e.route.getDistance().toFixed(3))==r?d++:d=0,l.draw(e,a),(d>=300||a>=1e3)&&(clearInterval(s),document.getElementById("start").disabled=!1)}),10))}static addPoint(){document.getElementById("start").disabled=!1,document.getElementById("start-limited").disabled=!1;let i=Math.floor(Math.random()*e),s=Math.floor(Math.random()*n);t.addPoint(i,s),o.getContext("2d").fillRect(i,s,4,4),document.getElementById("cities").innerHTML=t.points.length}static add5Point(){for(let t=0;t<5;t++)l.addPoint();document.getElementById("start").disabled=!1,document.getElementById("start-limited").disabled=!1}static draw(t,i){if(t.route.getDistance().toFixed(3)!=r){let i=o.getContext("2d");i.clearRect(0,0,e,n);for(let e=0;e<t.route.routeSize();e++){let n,s=t.route.getCity(e);i.fillRect(s.x,s.y,4,4),n=0==e?t.route.getCity(t.route.routeSize()-1):t.route.getCity(e-1),i.beginPath(),i.moveTo(s.x+2,s.y+2),i.lineTo(n.x+2,n.y+2),i.stroke()}}1==i?document.getElementById("distance-start").innerHTML=t.route.getDistance().toFixed(3):document.getElementById("distance-best").innerHTML=t.route.getDistance().toFixed(3),document.getElementById("iteration").innerHTML=i,r=Number(t.route.getDistance().toFixed(3))}static resetUI(){t.reset(),s&&clearInterval(s),a=0,d=0,o.getContext("2d").clearRect(0,0,e,n),document.getElementById("distance-start").innerHTML="?",document.getElementById("distance-best").innerHTML="?",document.getElementById("iteration").innerHTML=0,document.getElementById("cities").innerHTML=0,document.getElementById("add-5-point").disabled=!1,document.getElementById("add-point").disabled=!1,document.getElementById("start").disabled=!0,document.getElementById("start-limited").disabled=!0,document.getElementById("stop").disabled=!0}}l.init();for(let t=0;t<10;t++)l.addPoint()})()})();